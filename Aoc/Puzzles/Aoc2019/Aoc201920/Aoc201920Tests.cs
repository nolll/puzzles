namespace Pzl.Aoc.Puzzles.Aoc2019.Aoc201920;

public class Aoc201920Tests
{
    [Fact]
    public void FindsShortestRoute1()
    {
        const string input = """
                                      A           
                                      A           
                               #######.#########  
                               #######.........#  
                               #######.#######.#  
                               #######.#######.#  
                               #######.#######.#  
                               #####  B    ###.#  
                             BC...##  C    ###.#  
                               ##.##       ###.#  
                               ##...DE  F  ###.#  
                               #####    G  ###.#  
                               #########.#####.#  
                             DE..#######...###.#  
                               #.#########.###.#  
                             FG..#########.....#  
                               ###########.#####  
                                          Z       
                                          Z       
                             """;

        var solver = new DonutMazeSolver(input);

        solver.ShortestStepCount.Should().Be(23);
    }

    [Fact]
    public void FindsShortestRoute2()
    {
        const string input = """
                                                A               
                                                A               
                               #################.#############  
                               #.#...#...................#.#.#  
                               #.#.#.###.###.###.#########.#.#  
                               #.#.#.......#...#.....#.#.#...#  
                               #.#########.###.#####.#.#.###.#  
                               #.............#.#.....#.......#  
                               ###.###########.###.#####.#.#.#  
                               #.....#        A   C    #.#.#.#  
                               #######        S   P    #####.#  
                               #.#...#                 #......VT
                               #.#.#.#                 #.#####  
                               #...#.#               YN....#.#  
                               #.###.#                 #####.#  
                             DI....#.#                 #.....#  
                               #####.#                 #.###.#  
                             ZZ......#               QG....#..AS
                               ###.###                 #######  
                             JO..#.#.#                 #.....#  
                               #.#.#.#                 ###.#.#  
                               #...#..DI             BU....#..LF
                               #####.#                 #.#####  
                             YN......#               VT..#....QG
                               #.###.#                 #.###.#  
                               #.#...#                 #.....#  
                               ###.###    J L     J    #.#.###  
                               #.....#    O F     P    #.#...#  
                               #.###.#####.#.#####.#####.###.#  
                               #...#.#.#...#.....#.....#.#...#  
                               #.#####.###.###.#.#.#########.#  
                               #...#.#.....#...#.#.#.#.....#.#  
                               #.###.#####.###.###.#.#.#######  
                               #.#.........#...#.............#  
                               #########.###.###.#############  
                                        B   J   C               
                                        U   P   P               
                             """;

        var solver = new DonutMazeSolver(input);

        solver.ShortestStepCount.Should().Be(58);
    }

    [Fact]
    public void FindsShortestRouteRecursive()
    {
        const string input = """
                                          Z L X W       C                 
                                          Z P Q B       K                 
                               ###########.#.#.#.#######.###############  
                               #...#.......#.#.......#.#.......#.#.#...#  
                               ###.#.#.#.#.#.#.#.###.#.#.#######.#.#.###  
                               #.#...#.#.#...#.#.#...#...#...#.#.......#  
                               #.###.#######.###.###.#.###.###.#.#######  
                               #...#.......#.#...#...#.............#...#  
                               #.#########.#######.#.#######.#######.###  
                               #...#.#    F       R I       Z    #.#.#.#  
                               #.###.#    D       E C       H    #.#.#.#  
                               #.#...#                           #...#.#  
                               #.###.#                           #.###.#  
                               #.#....OA                       WB..#.#..ZH
                               #.###.#                           #.#.#.#  
                             CJ......#                           #.....#  
                               #######                           #######  
                               #.#....CK                         #......IC
                               #.###.#                           #.###.#  
                               #.....#                           #...#.#  
                               ###.###                           #.#.#.#  
                             XF....#.#                         RF..#.#.#  
                               #####.#                           #######  
                               #......CJ                       NM..#...#  
                               ###.#.#                           #.###.#  
                             RE....#.#                           #......RF
                               ###.###        X   X       L      #.#.#.#  
                               #.....#        F   Q       P      #.#.#.#  
                               ###.###########.###.#######.#########.###  
                               #.....#...#.....#.......#...#.....#.#...#  
                               #####.#.###.#######.#######.###.###.#.#.#  
                               #.......#.......#.#.#.#.#...#...#...#.#.#  
                               #####.###.#####.#.#.#.#.###.###.#.###.###  
                               #.......#.....#.#...#...............#...#  
                               #############.#.#.###.###################  
                                            A O F   N                     
                                            A A D   M                     
                             """;

        var solver = new RecursiveDonutMazeSolver(input);

        solver.ShortestStepCount.Should().Be(396);
    }
}