using FluentAssertions;

namespace Pzl.Everybody.Puzzles.Ece2024.Ece202420;

public class Ece202420Tests
{
    [Fact]
    public void Part1()
    {
        const string input = """
                             #....S....#
                             #.........#
                             #---------#
                             #.........#
                             #..+.+.+..#
                             #.+-.+.++.#
                             #.........#
                             """;

        Sut.Part1(input).Answer.Should().Be("1045");
    }

    [Fact]
    public void Part2_1()
    {
        const string input = """
                             ####S####
                             #-.+++.-#
                             #.+.+.+.#
                             #-.+.+.-#
                             #A+.-.+C#
                             #.+-.-+.#
                             #.+.B.+.#
                             #########
                             """;

        Sut.Part2(input).Answer.Should().Be("24");
    }
    
    [Fact]
    public void Part2_2()
    {
        const string input = """
                             ###############S###############
                             #+#..-.+.-++.-.+.--+.#+.#++..+#
                             #-+-.+-..--..-+++.+-+.#+.-+.+.#
                             #---.--+.--..++++++..+.-.#.-..#
                             #+-+.#+-.#-..+#.--.--.....-..##
                             #..+..-+-.-+.++..-+..+#-.--..-#
                             #.--.A.-#-+-.-++++....+..C-...#
                             #++...-..+-.+-..+#--..-.-+..-.#
                             #..-#-#---..+....#+#-.-.-.-+.-#
                             #.-+.#+++.-...+.+-.-..+-++..-.#
                             ##-+.+--.#.++--...-+.+-#-+---.#
                             #.-.#+...#----...+-.++-+-.+#..#
                             #.---#--++#.++.+-+.#.--..-.+#+#
                             #+.+.+.+.#.---#+..+-..#-...---#
                             #-#.-+##+-#.--#-.-......-#..-##
                             #...+.-+..##+..+B.+.#-+-++..--#
                             ###############################
                             """;

        Sut.Part2(input).Answer.Should().Be("78");
    }
    
    [Fact]
    public void Part2_3()
    {
        const string input = """
                             ###############S###############
                             #-----------------------------#
                             #-------------+++-------------#
                             #-------------+++-------------#
                             #-------------+++-------------#
                             #-----------------------------#
                             #-----------------------------#
                             #-----------------------------#
                             #--A-----------------------C--#
                             #-----------------------------#
                             #-----------------------------#
                             #-----------------------------#
                             #-----------------------------#
                             #-----------------------------#
                             #-----------------------------#
                             #--------------B--------------#
                             #-----------------------------#
                             #-----------------------------#
                             ###############################
                             """;

        Sut.Part2(input).Answer.Should().Be("206");
    }

    [Fact]
    public void Part3()
    {
        const string input = """
                             #......S......#
                             #-...+...-...+#
                             #.............#
                             #..+...-...+..#
                             #.............#
                             #-...-...+...-#
                             #.............#
                             #..#...+...+..#
                             """;

        Ece202420.RunPart3(input, 4).Should().Be(768790);
    }

    private static Ece202420 Sut => new();
}